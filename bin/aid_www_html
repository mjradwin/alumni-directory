#!/usr/local/bin/perl

# does the html version of just home pages

require 'getopts.pl';
require 'mv_util.pl';
require 'tableheader.pl';

$usage = 'usage: mv_www_html [-h] infile.adr outfile
    -h        Display usage information.
';

&Getopts('h') || die "$usage\n";
$opt_h && die "$usage\n";
$ARGV[0] || die "$usage\n";
$ARGV[1] || die "$usage\n";

open(DATA,$ARGV[0]) || die "Can't open $ARGV[0]: $!\n";
open(FMTOUT,">$ARGV[1]") || die "Can't open $ARGV[1]: $!\n";

$info_gif = "<img src=\"info.gif\" height=12 width=12 hspace=4 border=0 alt=\"[i]\">";
$blank_gif = "<img src=\"blank.gif\" height=12 width=12 hspace=4 border=0 alt=\"\">";
$cgi = &mv_config('cgi_path');

print FMTOUT &common_html_hdr(5,1);
print FMTOUT "<br>";
print FMTOUT &tableheader("Alumni with Web Pages", 1, 'ffff99',
'000000', 1);
print FMTOUT "<p>Any entries marked with\n" . &new_gif(0) .
"\nhave been added to the Directory within the last month.  The
$info_gif
icon lets you get more detailed information about an alumnus.</p>\n\n";
print FMTOUT "<pre>";
print FMTOUT "Name and Graduation Year$blank_gif                  Email\n";
print FMTOUT "---------------------------------------------------------------------------\n";

while(<DATA>) {
    chop;
    ($time,$id,$req,$last,$first,$married,
     $school,$year,$email,$alias,$homepage,$location) = &mv_parse($_);
    next if $homepage eq '';

    $fullname = &fullname($first,$last,$married);
    ($affil,$len) = &affiliate($year,$school,1);

    print FMTOUT "<a href=\"$cgi?about=$id\">$info_gif</a>";
    print FMTOUT "<a name=\"$alias\"";
    print FMTOUT ' ' x (8 - (length($alias)));
    print FMTOUT " href=\"$homepage\"";
    print FMTOUT ">";
    print FMTOUT $fullname;
    print FMTOUT "</a>";
    print FMTOUT $affil;
    print FMTOUT ' ', ' ' x (41 - (length($fullname) + $len));
    print FMTOUT "<a href=\"mailto:", $email, "\">", $email, "</a>";
    print FMTOUT " " . &new_gif(1) if &is_new($time);
    print FMTOUT "\n";
}

print FMTOUT "</pre>\n";
print FMTOUT &common_html_ftr(5);

exit(0);
