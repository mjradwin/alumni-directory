#!/usr/bin/perl -w

# $Id: aid_dbm_write,v 1.1 1999/01/21 16:40:17 mradwin Exp mradwin $

require 'aid_util.pl';

$dbFile = &aid_config('aiddir') . "data/master.adr";
@db = &aid_create_db($dbFile);

dbmopen(DB, 'master', 0666);
for (@db)
{
    next unless defined($_) && $_ ne '';
    %rec = &aid_split($_);

    $DB{$rec{'id'}} = 
	pack("C3N4", $rec{'valid'}, $rec{'request'}, $rec{'reunion'},
	     $rec{'bounce'}, $rec{'created'}, $rec{'time'}, $rec{'fresh'}) .
	join("\0",
	     $rec{'last'},
	     $rec{'married'},
	     $rec{'first'},
	     $rec{'school'},
	     $rec{'year'},
	     $rec{'email'},
	     $rec{'www'},
	     $rec{'location'},
	     $rec{'inethost'}
	     );

    $DB{$rec{'email'}} = $rec{'id'};
}
dbmclose(DB);
