#!/usr/local/bin/perl

#
# does the html version of the recent address list
# $Id: aid_recent_html,v 1.25 1998/01/02 20:14:18 mradwin Exp $
#

require 'aid_util.pl';

die "Usage: aid_recent_html infile.adr outfile.html\n" if !$ARGV[0] || !$ARGV[1];

$info_gif = &aid_image_tag('info');
$blank_gif = &aid_image_tag('blank');
$cgi = &aid_config('cgi_path');

open(DATA,$ARGV[0]) || die "Can't open $ARGV[0]: $!\n";
open(FMTOUT,">$ARGV[1]") || die "Can't open $ARGV[1]: $!\n";

print FMTOUT &common_html_hdr(4,1);
print FMTOUT "<br>";
print FMTOUT &aid_tableheader('Recent Additions to the Directory');
print FMTOUT
"<p>All entries on this page have been added to the Directory within the
last month.  The most recent additions or updates are at the bottom of the
list.  The $info_gif
icon lets you get more detailed information about an alumnus.</p>\n\n";
print FMTOUT "<pre>";
print FMTOUT "Name and Graduation Year$blank_gif                  Email\n";
print FMTOUT "---------------------------------------------------------------------------\n";

while(<DATA>) {
    chop;
    ($alias,
     $time,$id,$req,$last,$first,$married,
     $school,$year,$email,$homepage,$location) = &aid_parse($_);
    next unless &is_new($time);

    $fullname = &fullname($first,$last,$married);
    ($affil,$len) = &affiliate($year,$school,1);

    print FMTOUT "<a href=\"$cgi?about=$id\">$info_gif</a>";
    print FMTOUT "<a name=\"$alias\"";
    print FMTOUT " href=\"$homepage\"" if $homepage ne '';
    print FMTOUT ">";
    print FMTOUT $fullname;
    print FMTOUT "</a>";
    print FMTOUT $affil;
    print FMTOUT ' ', ' ' x (41 - (length($fullname) + $len));
    print FMTOUT "<a href=\"mailto:", $email, "\">", $email, "</a>";
    print FMTOUT "\n";
}

print FMTOUT "</pre>\n";
print FMTOUT &common_html_ftr(4);

exit(0);
