#!/usr/bin/perl -w

#
# does the html version of the recent address list
# $Id: aid_recent_html,v 2.3 1998/05/15 20:06:57 mradwin Exp mradwin $
#

require 'aid_util.pl';

die "Usage: aid_recent_html infile.adr outfile.html\n" if !$ARGV[0] || !$ARGV[1];

open(DATA,$ARGV[0]) || die "Can't open $ARGV[0]: $!\n";
open(FMTOUT,">$ARGV[1]") || die "Can't open $ARGV[1]: $!\n";

print FMTOUT &common_html_hdr(4,'Recent Additions to the Directory',1);
print FMTOUT
"<p>All entries on this page have been added to the Directory within the
last month.  The most recent additions or updates are at the top of the
page.</p>\n\n";

@newbies = ();
while(<DATA>) {
    chop;
    %rec = &aid_split($_);
    next unless $rec{'valid'};
    next unless &is_new($rec{'time'});
    push(@newbies,$_);
}

while (defined($_ = pop(@newbies))) {
    %rec = &aid_parse($_);
    &aid_write_verbose_entry(*FMTOUT,*rec,1,1);
}

print FMTOUT &common_html_ftr(4);

exit(0);
