#!/usr/local/bin/perl

# does the html version of just home pages

require 'mv_util.pl';
require 'getopts.pl';

$usage = 'usage: mv_home_html [-h] [-p <pg>] {-s | -i <infile> | -o <outfile> <infile>}
 -h            Display usage information.
 -p <pg>       Use page number <pg> for generating content.
 -i <infile>   Create the index page from html code in <infile>.
 -s            Create the submit page.
 -o <outfile>  Create an "other" page from html code in <infile>
    <infile>   and write to outfile.
';

&Getopts('hsio:p:') || die "$usage\n";
$opt_h && die "$usage\n";

$numopts = ($opt_o?1:0) + $opt_i + $opt_s;
die "$usage\n" unless $numopts == 1;
die "$usage\n" if !$opt_s && !$ARGV[0];

$pageno = $opt_p ? $opt_p : ($opt_o ? -1 : ($opt_s ? 5 : 0));
$infile = $ARGV[0];

$fmtout = $opt_o ? $opt_o : 
    ($opt_i) ? &mv_config('wwwdir') . &mv_config('index_page') :
    &mv_config('wwwdir') . "add.html";

if ($opt_i || $opt_o) {
    open(INFILE,$infile) || die "Can't open $infile: $!\n";
    @lines = <INFILE>;
    close(INFILE);
}

open(FMTOUT,">$fmtout") || die "Can't open $fmtout: $!\n";

print FMTOUT &common_html_hdr($pageno);
if ($opt_s) {
    print FMTOUT &submit_body(";-1;2;;;;MVHS;;;",0,0);
} else {
    print FMTOUT @lines;
}
print FMTOUT &common_html_ftr($pageno);

exit(0);
