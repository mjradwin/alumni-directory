#!/usr/local/bin/perl

# does the html version of the recent address list
#

@INC=('/u/mjr/doc/mvhs', '/usr/local/lib/perl');
require 'mv_util.pl';
require 'ctime.pl';

$now = time;
$today = &ctime(time);
chop $today;

die "Usage: mv_goners_html infile.adr outfile.html\n" if !$ARGV[0] || !$ARGV[1];
open(MVHS,$ARGV[0]) || die "Can't open $ARGV[0]: $!\n";
open(FMTOUT,">$ARGV[1]") || die "Can't open $ARGV[1]: $!\n";

print FMTOUT &common_html_hdr(-1, "Invalid Addresses");
print FMTOUT "<p>The following addresses are invalid.  If you know a new email\n";
print FMTOUT "address for anyone on this list, please <a href=\"add.html\">submit it</a>!</p>\n\n";
print FMTOUT "<pre>";
print FMTOUT "Name                       Email                           Grad. Class/School\n";
print FMTOUT "-----------------------------------------------------------------------------\n";

while(<MVHS>) {
    chop;
    ($time,$id,$req,$last,$first,$school,$year,$email,$alias,$homepage) = &mv_parse($_);

    if ($first) {
       $fullname = "$last, $first";
    } else {
       $fullname = $last;
    }
#    print FMTOUT '   ';
    print FMTOUT "<a href=\"$homepage\">" if $homepage ne '';
    print FMTOUT $fullname;
    print FMTOUT "</a>" if $homepage ne '';
    print FMTOUT ' ' x (27 - length($fullname));
    print FMTOUT $email;
    print FMTOUT ' ', ' ' x (36 - length($email));
    print FMTOUT $year;
    print FMTOUT " $school" if $school ne 'MVHS' && $school ne '';
#    print FMTOUT " <img alt=\"[new]\" WIDTH=28 HEIGHT=11 SRC=\"new.gif\">";
    print FMTOUT "\n";
}

print FMTOUT "</pre>\n";
print FMTOUT &common_html_ftr;

exit(0);
